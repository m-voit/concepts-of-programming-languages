<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Compare functional programming in Go with JavaScript</title>
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
        
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        <style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        
        
    </head>
    <body class="vscode-light">
        <h1 id="compare-functional-programming-in-go-with-javascript">Compare functional programming in Go with JavaScript</h1>
<p>This paper compares functional programming in Go with functional programming in JavaScript.
It compares the type system, functions and functional programming in Go with JavaScript.
Furthermore, an implementation of a parser for boolean expressions is used as a practical example to compare functional programming in the two programming languages.
At the end of the paper there will be an evaluation and summary on how suitable JavaScript is to implement a functional parser.
However, the main goal of this paper is to show the possibilities and support of functional programming concepts in JavaScript.</p>
<h2 id="table-of-contents">Table of contents</h2>
<!-- TODO -->
<!-- Monads -->
<h2 id="javascript-overview">JavaScript Overview</h2>
<p>JavaScript is a multi-paradigm programming language and a core technology of the internet.
It is a general purpose programming language and runs in the browser as well as on the server.
Despite often deceived as an object-oriented programming language, JavaScript also follows functional and imperative paradigms.
JavaScript is also event-driven and has good support for asynchronous programming [moz01][ant16].</p>
<!-- TODO Maybe take a look at the history of js. Scheme etc. -->
<p>However, to stay within the scope of this paper, we focus on the functional aspects of JavaScript, which will be presented in the following sections.</p>
<h2 id="parser-for-boolean-expressions">Parser for boolean expressions</h2>
<p>The parser for boolean expressions is a practical example to compare functional programming in Go and JavaScript.
It is implemented using functional programming concepts and will be used to provide code examples for various functional programming aspects discussed later.
Generally speaking the parser is built using parser combinators, which are a suited for functional programming.
The parser parses boolean expressions with the following EBNF grammar.</p>
<pre><code class="language-ebnf"><div>&lt;<span class="hljs-attribute">e</span><span class="hljs-attribute">x</span><span class="hljs-attribute">p</span><span class="hljs-attribute">r</span><span class="hljs-attribute">e</span><span class="hljs-attribute">s</span><span class="hljs-attribute">s</span><span class="hljs-attribute">i</span><span class="hljs-attribute">o</span><span class="hljs-attribute">n</span>&gt; ::= &lt;term&gt; { &lt;or&gt; &lt;term&gt; }
&lt;term&gt; ::= &lt;factor&gt; { &lt;and&gt; &lt;factor&gt; }
&lt;factor&gt; ::= &lt;var&gt; | &lt;not&gt; &lt;factor&gt; | (&lt;expression&gt;)
&lt;or&gt;  ::= <span class="hljs-string">'|'</span>
&lt;and&gt; ::= <span class="hljs-string">'&amp;'</span>
&lt;not&gt; ::= <span class="hljs-string">'!'</span>
&lt;var&gt; ::= <span class="hljs-string">'[a-zA-Z0-9]*'</span>
</div></code></pre>
<p>A valid expression would be <code>A &amp; B | !C</code>.
Depending on the values of A, B and C, which can be true or false, the parser determines the result of the expression.</p>
<h2 id="functional-programming-concepts">Functional programming concepts</h2>
<p>An important part of functional programming capabilities of a programming language are functions and how they are supported in a programming language.
As we are taking a look at JavaScript, we will see how JavaScript supports several important functional programming concepts.</p>
<h3 id="type-system">Type system</h3>
<p>JavaScript is a dynamic and weakly typed programming language, that also features duck-typing.
Because the language is weakly typed, types are implicitly cast depending on the used operation.
Furthermore, the dynamic typing allows for types to change their type at runtime, when their assigned value changes.</p>
<p>In the context of functional programming, the dynamic and weakly typing of JavaScript allows for writing easily reusable functions.
This is especially useful for higher order functions and function composition, because there is no need to do type casts or simulating <code>any</code> types.</p>
<pre><code class="language-javascript"><div>text = <span class="hljs-string">"Hello World!"</span>; <span class="hljs-comment">// Type of text is string.</span>
text = <span class="hljs-number">5</span>; <span class="hljs-comment">// Type of text now is number.</span>
</div></code></pre>
<p>In go the type system doesn't have generic types, so we have to use an empty interface to simulate an <code>any</code> type.
This makes the code more verbose and less readable than JavaScript code.
So this is no part where Go shines.
However, by using empty interfaces in go, it's possible to write flexible and reusable functions.</p>
<pre><code class="language-go"><div>TODO
</div></code></pre>
<h3 id="immutability">Immutability</h3>
<p>True immutability as desired by functional programming can't be achieved in JavaScript.
Although it's possible to create constructs that are sort of immutable, there is no true immutability like in functional only programming languages.</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">const</span> a = <span class="hljs-string">"Hello"</span>;
a = <span class="hljs-string">"World"</span>; <span class="hljs-comment">// Not possible.</span>

<span class="hljs-keyword">const</span> a = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Hello"</span> };
a.name = <span class="hljs-string">"World"</span>; <span class="hljs-comment">// Still possible.</span>
</div></code></pre>
<p>In JavaScript there are some ways to achieve immutability like the <code>const</code> keyword, introduced with ES6, that allows to define constant variables.
While <code>const</code> allows defining constant primitive types as strings, objects created with the <code>const</code> keyword are still mutable.
This is the case, because properties of constant objects, can still be reassigned after creation.</p>
<!-- Object deep freeze. -->
<pre><code class="language-go"><div>TODO
</div></code></pre>
<p>In Go immutability is quite similar to JavaScript.
Except strings, data types in Go are by default mutable and only primitive data types like <code>bool</code> and <code>int</code> can declared to be constant.
Immutability of composite data types like Go's <code>structs</code> is the responsibility of the developer.</p>
<p>To sum it up, there is some support for immutability in JavaScript in Go, but not enough to satisfy the functional paradigm.</p>
<h3 id="first-class-functions">First class functions</h3>
<p>First class functions are the foundation of supporting functional paradigms in a programming language.
A language with first class functions has to meet the following criteria:</p>
<ul>
<li>Allow passing functions as parameters to other functions.</li>
<li>Allow functions to be return values of other functions, so that functions can return functions.</li>
<li>Allow functions to be assigned to variables.</li>
<li>Allow functions to be stored in data structures like arrays.</li>
</ul>
<p>The listed properties also allow for concepts as higher-order functions and functional composition, which both are described later.
In JavaScript, all the mentioned properties are supported.
Therefore, functions in JavaScript are first class functions and are treated like first-class citizens in the programming language.</p>
<pre><code class="language-javascript"><div><span class="hljs-comment">/**
 * Parse [ \t\n\r]* from the Input.
 */</span>
<span class="hljs-keyword">const</span> expectSpaces = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> optional(expectSeveral(isSpaceChar, isSpaceChar));
</div></code></pre>
<pre><code class="language-go"><div><span class="hljs-comment">// ExpectSpaces parses a [ \t\n\r]* from the Input.</span>
<span class="hljs-keyword">var</span> ExpectSpaces Parser = ExpectSeveral(isSpaceChar, isSpaceChar).Optional()
</div></code></pre>
<h3 id="closures-and-lambda-expressions">Closures and lambda expressions</h3>
<p>Closures and lambda expression, also called anonymous functions, are unnamed functions, often returned from another function.
To be precise, a closure is the reference to the local state of the function, returning an anonymous function.
Closures are found in all programming languages with first class functions [moz01].</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">const</span> sum = <span class="hljs-function">(<span class="hljs-params">arg1, arg2</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> arg1 + arg2;
};
</div></code></pre>
<p>In JavaScript lambda expressions can be written very concise with the arrow functions syntax, introduced in ES6 [moz03].</p>
<pre><code class="language-go"><div>TODO
</div></code></pre>
<p>In Go lambda expressions are a bit more verbose, especially because the type system requires explicit types.
Otherwise lambda expessions in Go are equal to lambda expressions in JavaScript.</p>
<h3 id="higher-order-functions-and-function-composition">Higher-order functions and function composition</h3>
<p>Higher-order functions are functions that accept other functions arguments or return a function as result.
As discussed, JavaScript has first class functions, which allows using higher-order functions.</p>
<p>The convert function of the boolean parser for example takes two arguments.
A parser function to be executed and a converter function to convert the result of the parser function.
This higher order function can now be used for any desired parser function and with an arbitrary converter function.
The result is a highly flexible and easily reusable function.</p>
<pre><code class="language-javascript"><div><span class="hljs-comment">/**
 * Apply the converter to the result of a successful parse.
 * If the parser fails then do nothing.
 *
 * @param {any} parser The parser.
 * @param {any} converter A function to be applied to the parser result.
 * @returns Result.
 */</span>
<span class="hljs-keyword">const</span> convert = <span class="hljs-function">(<span class="hljs-params">parser, converter</span>) =&gt;</span> input =&gt; {
  <span class="hljs-keyword">const</span> result = parser(input);

  <span class="hljs-keyword">if</span> (result.result !== <span class="hljs-literal">null</span>) {
    result.result = converter(result.result);
  }

  <span class="hljs-keyword">return</span> result;
};
</div></code></pre>
<p>In Go, the converter function looks similar to the JavaScript implementation.
This is the case, because Go has similar support for higher-order functions as JavaScript.
The main differences between the Go and the JavaScript implementation are the empty interfaces to satisfy the Go type system and the higher verbosity of the Go code.</p>
<pre><code class="language-go"><div><span class="hljs-comment">// Convert applies the converter to the result of a successful parse.</span>
<span class="hljs-comment">// If the parser fails then Convert won't do anything.</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(parser Parser)</span> <span class="hljs-title">Convert</span><span class="hljs-params">(converter <span class="hljs-keyword">func</span>(<span class="hljs-keyword">interface</span>{})</span> <span class="hljs-title">interface</span></span>{}) Parser {
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(Input Input)</span> <span class="hljs-title">Result</span></span> {
    <span class="hljs-keyword">var</span> result = parser(Input)

    <span class="hljs-keyword">if</span> result.Result != <span class="hljs-literal">nil</span> {
      result.Result = converter(result.Result)
    }

    <span class="hljs-keyword">return</span> result
  }
}
</div></code></pre>
<p>Function composition is a concept that allows to build complex functions out of one or more simple functions.</p>
<!-- Currying -->
<p>Function composition works good with JavaScript, especially because of the permissive type system, discussed earlier.
It's easy in straight forward to use various functions to build complex functions with them.</p>
<p>In Go, function composition requires the programmer to use empty interfaces.
This is required, because of the Go type system as discussed earlier.</p>
<h3 id="pure-functions">Pure functions</h3>
<p>Pure functions are functions that have no side effects and no hidden inner state.
This means, a function, given the same input, always produces the same output.
To achieve this a pure function only uses its input and doesn't use or mutate internal state.
JavaScript allows writing pure functions, but doesn't have special constructs to enforce side effect free programming.</p>
<p>The same holds true for Go.
Like in JavaScript, it's possible writing pure and side effect free functions in Go, but there are no special constructs to enforce this.</p>
<p>Therefore, pure functions are possible in both languages, but it's in the hand of the programmer writing them.</p>
<h3 id="lazy-evaluation">Lazy evaluation</h3>
<p>There are two ways to evaluate functions, eager and lazy evaluation.
Programming languages that use eager evaluation, evaluate a function as soon as it's assigned or defined.
Lazy evaluation, on the other hand, means that functions are evaluated when they are executed, which may happen much later than the assignment.</p>
<p>Both, Go and JavaScript, use eager evaluation for functions.</p>
<!-- TODO Why is this relevant for functional programming -->
<h3 id="pattern-matching">Pattern matching</h3>
<p>JavaScript might get it with Proposal XY.
No support in Go.</p>
<h3 id="algebraic-data-types">Algebraic data types</h3>
<!-- Sum/Product types, discriminate unions -->
<p>Not possible with javascript, but with typescript a javascript superset.
No support in Go.</p>
<h2 id="summary">Summary</h2>
<!-- How good is functional JavaScript suited to implement a parser? -->
<h2 id="references">References</h2>
<ul>
<li>[ant16] JavaScript: Functional Programming for JavaScript Developers,Ved Antani; Simon Timms; Dan Mantyla, Packt Publishing, 2016-08-31</li>
<li>[fog13] Functional JavaScript, Michael Fogus, O'Reilly Media, Inc., 2013-06-10</li>
<li>[ker17] Mastering Javascript Functional Programming, Federico Kereki, Packt Publishing, 2017-12-29</li>
<li>[med01] <a href="https://medium.com/functional-javascript/introduction-to-functional-javascript-45a9dca6c64a">https://medium.com/functional-javascript/introduction-to-functional-javascript-45a9dca6c64a</a> (viewed 2019-12-21)</li>
<li>[moz01] <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures</a> (viewed 2019-12-23)</li>
<li>[moz02] <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Functions">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Functions</a> (viewed 2019-12-25)</li>
<li>[moz03] <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions</a> (viewed 2019-12-25)</li>
<li>[moz04] <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures</a> (viewed 2019-12-25)</li>
<li>[moz05] <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript">https://developer.mozilla.org/en-US/docs/Web/JavaScript</a> (viewed 2019-12-25)</li>
<li>[she17] Learning Functional Programming in Go, Lex Sheehan, Packt Publishing, 2017-11-24</li>
</ul>

    </body>
    </html>